# 2.2 Fetch API

‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∑‡∏≠ side effect ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏ú‡∏™‡∏≤‡∏ô `useEffect`, `fetch` ‡πÅ‡∏•‡∏∞ state ‡πÄ‡∏û‡∏∑‡πà‡∏≠ handle loading, success, error ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö

<br />

## ‡πÄ‡∏ä‡πá‡∏Å‡∏•‡∏¥‡∏™‡∏ï‡πå‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
1. ‡∏°‡∏µ state ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡∏ï‡∏±‡∏ß: `isLoading`, `error`, `data`
2. ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å request ‡πÄ‡∏°‡∏∑‡πà‡∏≠ component unmount ‡∏´‡∏£‡∏∑‡∏≠ dependency ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô
3. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° UI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ loading ‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏ì‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡πà‡∏≤‡∏á

<br />

## ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤

```jsx
import {useEffect, useState} from 'react';

export default function Courses() {
  const [courses, setCourses] = useState([]);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<null | string>(null);

  useEffect(() => {
    const controller = new AbortController();

    async function load() {
      try {
        setIsLoading(true);
        setError(null);

        const response = await fetch('/api/courses', {
          signal: controller.signal
        });
        if (!response.ok) throw new Error('Failed to load courses');

        const data = await response.json();
        setCourses(data);
      } catch (err) {
        if (err instanceof DOMException && err.name === 'AbortError') return;
        setError((err as Error).message);
      } finally {
        setIsLoading(false);
      }
    }

    load();
    return () => controller.abort();
  }, []);

  if (isLoading) {
    return <p className="text-slate-500">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤...</p>;
  }

  if (error) {
    return (
      <div className="rounded-lg border border-red-200 bg-red-50 p-4 text-red-800">
        ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: {error}
      </div>
    );
  }

  if (courses.length === 0) {
    return <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏•‡∏¢!</p>;
  }

  return (
    <ul className="space-y-3">
      {courses.map((course: any) => (
        <li key={course.id} className="rounded-xl border border-slate-200 p-4">
          <h3 className="text-lg font-semibold">{course.title}</h3>
          <p className="text-sm text-slate-600">{course.summary}</p>
        </li>
      ))}
    </ul>
  );
}
```

<br />

## ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö
- ‡∏¢‡πâ‡∏≤‡∏¢ logic fetch ‡πÑ‡∏õ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô custom hook (`useCourses`) ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ã‡πâ‡∏≥‡∏´‡∏•‡∏≤‡∏¢ component
- ‡∏ñ‡πâ‡∏≤ URL ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ‡πÉ‡∏´‡πâ memoize ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ refetch ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
- ‡πÉ‡∏ô Next.js ‡∏ñ‡πâ‡∏≤‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≠‡∏ô server-render ‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏ó‡∏µ‡πà Server Component ‡∏´‡∏£‡∏∑‡∏≠ `getServerSideProps`

<br />

## Workshop
- ‡∏™‡∏£‡πâ‡∏≤‡∏á fake API ‡∏î‡πâ‡∏ß‡∏¢ `setTimeout` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏µ‡πÄ‡∏•‡∏¢‡πå ‡πÅ‡∏•‡πâ‡∏ß‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ loading
- ‡πÄ‡∏û‡∏¥‡πà‡∏° pagination ‡∏´‡∏£‡∏∑‡∏≠ search param ‡πÅ‡∏•‡πâ‡∏ß refetch ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå
- ‡∏•‡πá‡∏≠‡∏Å error ‡πÉ‡∏ô console ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢‡πÉ‡∏ô UI

> üí° ‡πÉ‡∏ä‡πâ Playground ‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏•‡∏∞‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÑ‡∏î‡πâ‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤.
